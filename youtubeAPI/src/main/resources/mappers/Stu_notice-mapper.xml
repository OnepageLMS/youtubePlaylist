<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Stu_Notice">
	<select id="getAllNotice" resultType="notice">
		select * from lms_notice left join (select * from lms_noticeCheck where studentID=#{studentID}) nc
		on lms_notice.id = nc.noticeID 
		where lms_notice.classID=#{classID} order by lms_notice.id desc
	</select>
	
	<insert id="insertView">
		insert into lms_noticeCheck (noticeID, studentID)
		values (#{id}, #{studentID})
	</insert>
	
	<update id="updateViewCount">
		update lms_notice
		set viewCount = ( select count(*)
			from lms_noticeCheck
			where noticeID=#{id} )
		where id=#{id}
	</update>
</mapper>